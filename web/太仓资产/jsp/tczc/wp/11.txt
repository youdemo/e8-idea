select wpmc,xh,(select unitname from LgcAssetUnit where id=a.dw) as dw,dbo.f_get_wpdj(a.id,'2020-04-01','0') as sqjcdj,dbo.f_get_wpsl(a.id,'2020-04-01','0') as sqjcsl,cast(dbo.f_get_wpdj(a.id,'2020-04-01','0')*dbo.f_get_wpsl(a.id,'2020-04-01','0') as numeric(10,2)) as sqjcxj ,cast(cast(dbo.f_get_wpdj(a.id,'2020-04-01','0')*dbo.f_get_wpsl(a.id,'2020-04-01','0') as numeric(10,2))/(1+dbo.f_get_wprate(a.id,'2020-04-01','0')) as numeric(10,2)) as sqjcbhs
,dbo.f_get_wpdj(a.id,'2020-04-01','1') as bqgrdj,dbo.f_get_wpsl(a.id,'2020-04-01','1') as bqgrsl,cast(dbo.f_get_wpdj(a.id,'2020-04-01','1')*dbo.f_get_wpsl(a.id,'2020-04-01','1') as numeric(10,2)) as bqgrxj,cast(cast(dbo.f_get_wpdj(a.id,'2020-04-01','1')*dbo.f_get_wpsl(a.id,'2020-04-01','1') as numeric(10,2))/(1+dbo.f_get_wprate(a.id,'2020-04-01','1')) as numeric(10,2)) as bqgrbhs
,dbo.f_get_wpdj(a.id,'2020-04-01','2') as bqlydj,dbo.f_get_wpsl(a.id,'2020-04-01','2') as bqlysl,cast(dbo.f_get_wpdj(a.id,'2020-04-01','2')*dbo.f_get_wpsl(a.id,'2020-04-01','2') as numeric(10,2)) as bqlyxj,cast(cast(dbo.f_get_wpdj(a.id,'2020-04-01','2')*dbo.f_get_wpsl(a.id,'2020-04-01','2') as numeric(10,2))/(1+dbo.f_get_wprate(a.id,'2020-04-01','2')) as numeric(10,2)) as bqlybhs
,dbo.f_get_wpdj(a.id,'2020-04-01','3') as bqjcdj,dbo.f_get_wpsl(a.id,'2020-04-01','3') as bqjcsl,cast(dbo.f_get_wpdj(a.id,'2020-04-01','3')*dbo.f_get_wpsl(a.id,'2020-04-01','3') as numeric(10,2)) as bqjcxj,cast(cast(dbo.f_get_wpdj(a.id,'2020-04-01','3')*dbo.f_get_wpsl(a.id,'2020-04-01','3') as numeric(10,2))/(1+dbo.f_get_wprate(a.id,'2020-04-01','3')) as numeric(10,2)) as bqjcbhs
from uf_bgypk a